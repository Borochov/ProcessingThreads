# ProcessingThreads - Multi-threaded Data Processing System

A C++17 multi-threaded application demonstrating concurrent data generation, function generation, and processing using thread-safe queues.

## Requirements

- CMake 3.16 or higher
- C++17 compatible compiler (GCC 7+, Clang 5+, MSVC 2017+)
- Threading support (pthreads on Linux/macOS)

## Building

### Linux/macOS
```bash
mkdir build
cd build
cmake ..
make
```

### Windows (Visual Studio)
```bash
mkdir build
cd build
cmake ..
cmake --build . --config Release
```

## Usage

The program creates three types of threads that work together:

```bash
./processing_threads <NF> <ND> <NP> <NA>
```

### Parameters:
- **NF**: Number of function threads (generate arithmetic functions)
- **ND**: Number of data threads (generate random values: int, float, complex)
- **NP**: Number of processing threads (consume and process data)
- **NA**: Number of functions to apply before stopping

### Examples:
```bash
# Small test case
./processing_threads 2 3 2 10

# Medium workload
./processing_threads 5 8 4 50

# Large stress test (tests deadlock prevention)
./processing_threads 20 30 20 100
```

## How It Works

### Data Threads
- Generate random integers (-100 to 100)
- Generate random floats (-100.0 to 100.0)
- Generate random complex numbers (-100Â±100i)
- Store values in thread-safe queues with maximum capacity (calculated at run time)

### Function Threads
- Generate arithmetic operations: +, -, *, /
- Create functions with different patterns:
  - `x + y` (needs 2 data values)
  - `x + 5` (needs 1 data value)
  - `3 + 7` (needs 0 data values)

### Processing Threads
- Randomly select two queues for operations:
  - **Data + Data**: Transfer values between queues
  - **Function + Data**: Apply function to data and print result
  - **Function + Function**: Ignore (as specified)

### Sample Output:
```
Function: {(3 + 4i) * x}; parameters: (-2 + 1i); result: (-10 - 5i)
Function: {x + y}; parameters: 42, -17.5; result: 24.5
Transferred 73.2 from queue 5 to queue 12
```

## Testing

Run the test suite:
```bash
./test_runner
```

Or with parameters:
```bash
./test_runner 3 2  # Test with 3 data threads, 2 function threads
```

## Architecture Features

- **Thread-safe queues** with configurable capacity
- **Dynamic queue sizing** based on thread count to prevent deadlocks
- **Type-safe variant** handling (int, float, complex<double>)
- **Atomic counters** for thread coordination
- **Graceful shutdown** when target function count reached

## Data Range Configuration

Data generation ranges are centrally configured:
```cpp
constexpr int DATA_MIN_VALUE = -100;
constexpr int DATA_MAX_VALUE = 100;
```

Queue capacity scales automatically: `capacity = producers * 10`

## UML Class Diagram
see `./uml_class_diagram.mermaid`

To render this diagram:
1. Copy the mermaid code block
2. Paste it into [Mermaid Live Editor](https://mermaid.live/)
3. Or view directly on GitHub (auto-renders Mermaid diagrams)

## Troubleshooting

- **Build failures**: Ensure C++17 support and CMake 3.16+
- **Thread issues**: Verify threading library availability